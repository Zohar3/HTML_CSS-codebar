define(["require","exports","modules/clean/ajax","modules/core/browser","modules/clean/sharing/api/client","modules/constants/file_viewer","modules/clean/file_store/utils","modules/clean/viewer","modules/clean/react/paper/paper_log","modules/core/i18n","modules/clean/react/bubble_dropdown_v2","modules/core/notify","modules/clean/react/size_class/constants"],function(e,o,r,n,t,i,a,s,l,d,c,u,p){"use strict";function _(e){var o=e.file,r=e.sharedLink;return h(e)?P(o)?r?I.Button:I.Dropdown:I.Ellipsis:I.Off}function f(e){return e===I.Dropdown||e===I.Ellipsis?c.BubbleDropdownPositions.BOTTOM_LEFT:c.BubbleDropdownPositions.BOTTOM}function b(){return"ON"===i.EMBED_TO_PAPER_ONBOARDING_VARIANT}function h(e){var o=e.file,r=e.user,t=e.sharedLink;return!!o&&((P(o)&&x.includes(i.OPEN_IN_PAPER_VARIANT)||m(o)&&B.includes(i.EMBED_TO_PAPER_VARIANT))&&!s.Viewer.get_viewer().is_assume_user_session&&!n.is_mobile_or_tablet()&&n.is_supported_paper_browser()&&(!r&&!!t||!!r&&!r.is_paper_disabled))}function m(e){var o=a.getExtension(e);return!!o&&E.includes(o)}function P(e){var o=a.getExtension(e);return!!o&&(C.includes(o)&&e.bytes<20971520)}function A(e){var o=d._("Copy to Paper");return m(e)&&(o=d._("Add to Paper doc")),o}function T(e,o){return m(e)&&o===p.SizeClass.Large}function g(e){return m(e)?d._("Bring it all together"):d._("Bring this doc to life")}function k(e){return m(e)?d._("Add this file to a Paper doc to collect ideas and organize your thoughts."):d._("Copy to Paper and make changes or ask for feedback.")}function O(e){var o=e.file,n=e.sharedLink,t=e.contUrl,i=e.successCallback,a=e.errorCallback,s=e.extension,l=e._tk,d=e.oqa,c=e.fromModal;r.WebRequest({url:"/paper/sign_request_data",data:{path:o.file_id,sharedLink:n,cont_url:t,extension:s,_tk:l,oqa:d,fromModal:c},success:i,error:a})}function w(e){var o=window.open("","_blank"),r=function(e){o?n.redirect(e,o):n.redirect(e)},i=function(){o&&o.close(),u.Notify.error(d._("Canâ€™t copy file to Paper"))},s=e.sharedLink?e.sharedLink:"",c=e.file,p=e.user,_=e.fromModal,f=e.sharedLink?"shared_file_actions":"mounted_file_actions",b=a.getExtension(c);l.paperLog(l.PaperEventTypes.CTA_CLICK,{source:f,cta:"open_in_paper_button",extension:b});var h=b,m={file:c,sharedLink:s,contUrl:"/create-doc-from-dropbox-file",extension:b,successCallback:r,errorCallback:i,_tk:"dropbox_web_copy_from_previews",oqa:h,fromModal:_};if(P(c))O(m);else if(m._tk="dropbox_web_embed_from_previews",!s&&p){var A=new t.FileShareApiClient({userId:p.id});A.sharedLinkInfo({fileIdOrPath:c.file_id}).then(function(e){e?(m.sharedLink=e.url,m.contUrl="/dropbox-file-embed",O(m)):A.createSharedLink({fileIdOrPath:c.file_id}).then(function(e){m.sharedLink=e.url,m.contUrl="/dropbox-file-embed",O(m)}).catch(function(e){i&&i()})}).catch(function(e){i&&i()})}else m.contUrl="/dropbox-file-embed",O(m)}Object.defineProperty(o,"__esModule",{value:!0});var I,x=["VARIANT_A","VARIANT_B1","VARIANT_B2","VARIANT_B3","VARIANT_B4","ON"],B=["BUTTON","DROPDOWN","ELLIPSIS"],C=["docx"],E=["jpg","jpeg","png","pdf","xls","xlsx","mp4","mov","pptx","ppt","zip","rar","mp3"];(function(e){e[e.Off=1]="Off",e[e.Control=2]="Control",e[e.Button=3]="Button",e[e.Dropdown=4]="Dropdown",e[e.Ellipsis=5]="Ellipsis"})(I=o.OpenInPaperButtonVariant||(o.OpenInPaperButtonVariant={})),o.getOpenInPaperButtonVariant=_,o.getCalloutPosition=f,o.shouldShowEmbedToPaperModal=b,o.shouldShowOpenInPaper=h,o.fileSupportsEmbedToPaper=m,o.fileSupportsCopyToPaper=P,o.getCTAText=A,o.shouldShowCTADescription=T,o.getCalloutTitle=g,o.getCalloutMessage=k,o.createPaperAccountAndRedirect=O,o.openFileInPaper=w});
//# sourceMappingURL=utils.min.js-vflunYhac.map